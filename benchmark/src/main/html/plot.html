<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>D3: Test of formatted axis values</title>
<!--    <script type="text/javascript" src="../d3/d3.v3.js"></script> -->
    <script type="text/javascript" src="http://d3js.org/d3.v3.js"></script>
    <style type="text/css">

        path {
        stroke: red;
        stroke-width: 2;
        fill: none;
        }

        .axis path,
        .axis line {
        fill: none;
        stroke: black;
        shape-rendering: crispEdges;
        }

        .axis text {
        font-family: sans-serif;
        font-size: 11px;
        }
    </style>
</head>
<body>
<div id="chart1"/>
<div id="chart2"/>
<script type="text/javascript">

	var createXScale = function(w,h,padding,latestData) {
		return d3.scale//.linear()
				.log().base(2)
				.domain([d3.min(latestData, function(d) { return Number(d.nodes); }),
							d3.max(latestData, function(d) { return Number(d.nodes); })])
				.range([padding, w - padding * 2])
	}

	var createYScale = function(w,h,padding,latestData) {
		return d3.scale//.linear()
				.log().base(2)
				 .domain([d3.min(latestData, function(d) { if(Number(d.measured) < Number(d.expected)) return Number(d.measured)
															else return Number(d.expected)}),
						d3.max(latestData, function(d) { if(Number(d.measured) > Number(d.expected)) return Number(d.measured)
															else return Number(d.expected)
				  })])
				 .range([h - padding, padding])
	}

	var createXAxis = function(w,h,padding,xScale,svg) {
	    var xAxis= d3.svg.axis()
                  .scale(xScale)
                  .orient("bottom")
                  .tickFormat(function (d) {
                    return xScale.tickFormat(4,d3.format(",d"))(d)
                    })
        svg.append("g")
                .attr("class", "axis")
                .attr("transform", "translate(0," + (h - padding) + ")")
                .call(xAxis);

        return xAxis
	}

    var createYAxis = function(w,h,padding,yScale,svg) {
        var yAxis = d3.svg.axis()
                  .scale(yScale)
                  .orient("left")
                 // .tickFormat(function (d) {
                 //   return yScale.tickFormat(4,d3.format(",d"))(d)
                 //   })

        svg.append("g")
					.attr("class", "axis")
					.attr("transform", "translate(" + padding + ",0)")
					.call(yAxis);

        return yAxis
    }

    var createDots = function() {

    }

	var plotResults = function(containerId,primaryFile,otherFile) {

		var w = 1600;
		var h = 900;
		var padding = 120;

		d3.csv(primaryFile, function(latestData) {
			d3.csv(otherFile, function(standardData) {

				//Create scale functions
				var xScale = createXScale(w,h,padding,latestData)

				var yScale = createYScale(w,h,padding,latestData)

				//Create SVG element
				var svg = d3.select("body").select(containerId)
							.append("svg")
							.attr("width", w)
							.attr("height", h);

				//Define X axis
				var xAxis = createXAxis(w,h,padding,xScale,svg)
				//Define Y axis
				var yAxis = createYAxis(w,h,padding,yScale,svg)

                console.log(latestData[0])
                console.log(latestData[0]["nodes"])

				//Create circles
				svg.selectAll("measured")
				   .data(latestData)
				   .enter()
				   .append("circle")
				   .attr("cx", function(d) {
						return xScale(Number(d.nodes));
				   })
				   .attr("cy", function(d) {
						return yScale(Number(d.measured));
				   })
				   .attr("r", 4)
				   .attr("fill", "blue");

				svg.selectAll("expected")
				   .data(latestData)
				   .enter()
				   .append("circle")
				   .attr("cx", function(d) {
						return xScale(Number(d.nodes));
				   })
				   .attr("cy", function(d) {
						return yScale(Number(d.expected));
				   })
				   .attr("r", 4)
				   .attr("fill", "red");

				svg.selectAll("jung")
				   .data(standardData)
				   .enter()
				   .append("circle")
				   .attr("cx", function(d) {
						return xScale(Number(d.nodes));
				   })
				   .attr("cy", function(d) {
						return yScale(Number(d.measured));
				   })
				   .attr("r", 4)
				   .attr("fill", "green");

				var valueline = d3.svg.line()
					.x(function(d) { return xScale(d.nodes); })
					.y(function(d) { return yScale(d.expected); });
				svg.append("path")
					.attr("class", "expectedLine")
					.attr("d", valueline(latestData))
					.attr("stroke", "red");
			} )
		})
    }
    plotResults("#chart1","../../../../benchmark/results/v0.1.2/dijkstra.csv","../../../../benchmark/results/v0.1.2/jung.csv")
    plotResults("#chart2","../../../../benchmark/results/v0.1.2/dijkstra.csv","../../../../benchmark/results/v0.1.2/jung.csv")
		</script>
</body>
</html>